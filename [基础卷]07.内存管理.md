## 内存基础知识

### 内存区域的划分
1. 栈：局部变量
2. 堆：手动创建和管理的内存空间，使用 `new` 和 `malloc` 请求创建，`delete` 和 `free` 来回收，如果管理不当，会造成内存泄漏
3. 常量存储区：程序启动时自动创建的只读内存空间，用来存储 `const` 常量以及代码中的字符串
4. 静态存储区：程序启动时自动创建的内存空间，在 `main` 函数之前创建，用来存储静态变量和全局变量，可读可写，但不能动态创建
5. 代码存储区：存储代码二进制内容的只读空间


### new 和 malloc 的区别
1. `new` 分配的内存使用 `delete` 来释放，`malloc` 分配的内存使用 `free` 来释放
2. `new/delete` 是操作符，`malloc/free` 是标准库函数
3. `malloc/free` 只分配、释放内存，`new/delete` 还可以用于创建、释放对象，会自动执行对象的构造和析构函数
4. `new/delete` 的写法比 `malloc/free` 简洁 *(这个不值一提吧)*
5. `new/delete` 在创建数组时需要特别注意，比如：`int* p = new int[100];`，在释放时，也要加上`[]`，比如：`delete []p;`


### 堆和栈的区别
1. 栈空间是系统自动分配和回收的，堆空间是程序员动态分配和回收的
2. 栈空间是有限的，当超出时，就会出现溢出，Linux下默认的栈空间为**10MB**，Windows默认为**1MB**；而堆空间一般足够大，在32位系统下，理论上有**4GB**可用
3. 栈空间的内存地址是连续的，效率高；堆空间的内存地址是不连续的，效率较低，切容易产生内存碎片
**总结：**
1. 要控制对象的生命周期，必须用堆；
2. 需要分配大块内存，必须用堆；
3. 需要分配的内存大小是动态的，倾向于用堆；
4. 其他情况尽量用栈，以保证安全高效，无内存碎片，减少内存泄漏。

---

## 内存泄漏、野指针和跨动态链接库的内存使用


